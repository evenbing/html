function pickerDateRange(t,e){var a={aToday:"aToday",aYesterday:"aYesterday",aRecent7Days:"aRecent7Days",aRecent14Days:"aRecent14Days",aRecent30Days:"aRecent30Days",aRecent90Days:"aRecent90Days",startDate:"",endDate:"",startCompareDate:"",endCompareDate:"",minValidDate:"315507600",maxValidDate:"",success:function t(e){return true},startDateId:"startDate",startCompareDateId:"startCompareDate",endDateId:"endDate",endCompareDateId:"endCompareDate",target:"",needCompare:false,suffix:"",inputTrigger:"input_trigger",compareTrigger:"compare_trigger",compareCheckboxId:"needCompare",calendars:2,dayRangeMax:0,monthRangeMax:12,dateTable:"dateRangeDateTable",selectCss:"dateRangeSelected",compareCss:"dateRangeCompare",coincideCss:"dateRangeCoincide",firstCss:"first",lastCss:"last",clickCss:"today",disableGray:"dateRangeGray",isToday:"dateRangeToday",joinLineId:"joinLine",isSingleDay:false,defaultText:" 至 ",singleCompare:false,stopToday:true,isTodayValid:false,weekendDis:false,disCertainDay:[],disCertainDate:[],shortOpr:false,noCalendar:false,theme:"gri",magicSelect:false,autoCommit:false,autoSubmit:false,replaceBtn:"btn_compare"};var s=this;this.inputId=t;this.inputCompareId=t+"Compare";this.compareInputDiv="div_compare_"+t;this.mOpts=$.extend({},a,e);this.mOpts.calendars=Math.min(this.mOpts.calendars,3);this.mOpts.compareCss=this.mOpts.theme=="ta"?this.mOpts.selectCss:this.mOpts.compareCss;this.periodObj={};this.periodObj[s.mOpts.aToday]=0;this.periodObj[s.mOpts.aYesterday]=1;this.periodObj[s.mOpts.aRecent7Days]=6;this.periodObj[s.mOpts.aRecent14Days]=13;this.periodObj[s.mOpts.aRecent30Days]=29;this.periodObj[s.mOpts.aRecent90Days]=89;this.startDefDate="";var i=""==this.mOpts.suffix?(new Date).getTime():this.mOpts.suffix;this.calendarId="calendar_"+i;this.dateListId="dateRangePicker_"+i;this.dateRangeCompareDiv="dateRangeCompareDiv_"+i;this.dateRangeDiv="dateRangeDiv_"+i;this.compareCheckBoxDiv="dateRangeCompareCheckBoxDiv_"+i;this.submitBtn="submit_"+i;this.closeBtn="closeBtn_"+i;this.preMonth="dateRangePreMonth_"+i;this.nextMonth="dateRangeNextMonth_"+i;this.startDateId=this.mOpts.startDateId+"_"+i;this.endDateId=this.mOpts.endDateId+"_"+i;this.compareCheckboxId=this.mOpts.compareCheckboxId+"_"+i;this.startCompareDateId=this.mOpts.startCompareDateId+"_"+i;this.endCompareDateId=this.mOpts.endCompareDateId+"_"+i;var d={gri:['<div id="'+this.calendarId+'" class="gri_dateRangeCalendar">','<table class="gri_dateRangePicker"><tr id="'+this.dateListId+'"></tr></table>','<div class="gri_dateRangeOptions" '+(this.mOpts.autoSubmit?' style="display:none" ':"")+">",'<div class="gri_dateRangeInput" id="'+this.dateRangeDiv+'" >','<input type="text" class="gri_dateRangeInput" name="'+this.startDateId+'" id="'+this.startDateId+'" value="'+this.mOpts.startDate+'" readonly />','<span id="'+this.mOpts.joinLineId+'"> - </span>','<input type="text" class="gri_dateRangeInput" name="'+this.endDateId+'" id="'+this.endDateId+'" value="'+this.mOpts.endDate+'" readonly /><br />',"</div>",'<div class="gri_dateRangeInput" id="'+this.dateRangeCompareDiv+'">','<input type="text" class="gri_dateRangeInput" name="'+this.startCompareDateId+'" id="'+this.startCompareDateId+'" value="'+this.mOpts.startCompareDate+'" readonly />','<span class="'+this.mOpts.joinLineId+'"> - </span>','<input type="text" class="gri_dateRangeInput" name="'+this.endCompareDateId+'" id="'+this.endCompareDateId+'" value="'+this.mOpts.endCompareDate+'" readonly />',"</div>","<div>",'<input type="button" name="'+this.submitBtn+'" id="'+this.submitBtn+'" value="确定" />','&nbsp;<a id="'+this.closeBtn+'" href="javascript:;">关闭</a>',"</div>","</div>","</div>"],ta:['<div id="'+this.calendarId+'" class="ta_calendar ta_calendar2 cf">','<div class="ta_calendar_cont cf" id="'+this.dateListId+'">',"</div>",'<div class="ta_calendar_footer cf" '+(this.mOpts.autoSubmit?' style="display:none" ':"")+">",'<div class="frm_msg">','<div id="'+this.dateRangeDiv+'">','<input type="text" class="ta_ipt_text_s" name="'+this.startDateId+'" id="'+this.startDateId+'" value="'+this.mOpts.startDate+'" readonly />','<span class="'+this.mOpts.joinLineId+'"> - </span>','<input type="text" class="ta_ipt_text_s" name="'+this.endDateId+'" id="'+this.endDateId+'" value="'+this.mOpts.endDate+'" readonly /><br />',"</div>",'<div id="'+this.dateRangeCompareDiv+'">','<input type="text" class="ta_ipt_text_s" name="'+this.startCompareDateId+'" id="'+this.startCompareDateId+'" value="'+this.mOpts.startCompareDate+'" readonly />','<span class="'+this.mOpts.joinLineId+'"> - </span>','<input type="text" class="ta_ipt_text_s" name="'+this.endCompareDateId+'" id="'+this.endCompareDateId+'" value="'+this.mOpts.endCompareDate+'" readonly />',"</div>","</div>",'<div class="frm_btn">','<input class="ta_btn ta_btn_primary" type="button" name="'+this.submitBtn+'" id="'+this.submitBtn+'" value="确定" />','<input class="ta_btn" type="button" id="'+this.closeBtn+'" value="取消"/>',"</div>","</div>","</div>"]};var r={gri:['<label class="gri_contrast" for ="'+this.compareCheckboxId+'">','<input type="checkbox" class="gri_pc" name="'+this.compareCheckboxId+'" id="'+this.compareCheckboxId+'" value="1"/>对比',"</label>",'<input type="text" name="'+this.inputCompareId+'" id="'+this.inputCompareId+'" value="" class="gri_date"/>'],ta:['<label class="contrast" for ="'+this.compareCheckboxId+'">','<input type="checkbox" class="pc" name="'+this.compareCheckboxId+'" id="'+this.compareCheckboxId+'" value="1"/>对比',"</label>",'<div class="ta_date" id="'+this.compareInputDiv+'">','\t<span name="dateCompare" id="'+this.inputCompareId+'" class="date_title"></span>','\t<a class="opt_sel" id="'+this.mOpts.compareTrigger+'" href="#">','\t\t<i class="i_orderd"></i>',"\t</a>","</div>"]};if(this.mOpts.theme=="ta"){$(r[this.mOpts.theme].join("")).insertAfter($("#div_"+this.inputId))}else{$(r[this.mOpts.theme].join("")).insertAfter($("#"+this.inputId))}if(this.mOpts.noCalendar){$("#"+this.inputId).css("display","none");$("#"+this.compareCheckboxId).parent().css("display","none")}$(0<$("#appendParent").length?"#appendParent":document.body).append(d[this.mOpts.theme].join(""));$("#"+this.calendarId).css("z-index",9999);if(1>$("#"+this.mOpts.startDateId).length){$(""!=this.mOpts.target?"#"+this.mOpts.target:"body").append('<input type="hidden" id="'+this.mOpts.startDateId+'" name="'+this.mOpts.startDateId+'" value="'+this.mOpts.startDate+'" />')}else{$("#"+this.mOpts.startDateId).val(this.mOpts.startDate)}if(1>$("#"+this.mOpts.endDateId).length){$(""!=this.mOpts.target?"#"+this.mOpts.target:"body").append('<input type="hidden" id="'+this.mOpts.endDateId+'" name="'+this.mOpts.endDateId+'" value="'+this.mOpts.endDate+'" />')}else{$("#"+this.mOpts.endDateId).val(this.mOpts.endDate)}if(1>$("#"+this.mOpts.compareCheckboxId).length){$(""!=this.mOpts.target?"#"+this.mOpts.target:"body").append('<input type="checkbox" id="'+this.mOpts.compareCheckboxId+'" name="'+this.mOpts.compareCheckboxId+'" value="0" style="display:none;" />')}if(false==this.mOpts.needCompare){$("#"+this.compareInputDiv).css("display","none");$("#"+this.compareCheckBoxDiv).css("display","none");$("#"+this.dateRangeCompareDiv).css("display","none");$("#"+this.compareCheckboxId).attr("disabled",true);$("#"+this.startCompareDateId).attr("disabled",true);$("#"+this.endCompareDateId).attr("disabled",true);$("#"+this.compareCheckboxId).parent().css("display","none");$("#"+this.mOpts.replaceBtn).length>0&&$("#"+this.mOpts.replaceBtn).hide()}else{if(1>$("#"+this.mOpts.startCompareDateId).length){$(""!=this.mOpts.target?"#"+this.mOpts.target:"body").append('<input type="hidden" id="'+this.mOpts.startCompareDateId+'" name="'+this.mOpts.startCompareDateId+'" value="'+this.mOpts.startCompareDate+'" />')}else{$("#"+this.mOpts.startCompareDateId).val(this.mOpts.startCompareDate)}if(1>$("#"+this.mOpts.endCompareDateId).length){$(""!=this.mOpts.target?"#"+this.mOpts.target:"body").append('<input type="hidden" id="'+this.mOpts.endCompareDateId+'" name="'+this.mOpts.endCompareDateId+'" value="'+this.mOpts.endCompareDate+'" />')}else{$("#"+this.mOpts.endCompareDateId).val(this.mOpts.endCompareDate)}if(""==this.mOpts.startCompareDate||""==this.mOpts.endCompareDate){$("#"+this.compareCheckboxId).attr("checked",false);$("#"+this.mOpts.compareCheckboxId).attr("checked",false)}else{$("#"+this.compareCheckboxId).attr("checked",true);$("#"+this.mOpts.compareCheckboxId).attr("checked",true)}}this.dateInput=this.startDateId;this.changeInput(this.dateInput);$("#"+this.startDateId).bind("click",function(){if(s.endCompareDateId==s.dateInput){$("#"+s.startCompareDateId).val(s.startDefDate)}s.startDefDate="";s.removeCSS(1);s.changeInput(s.startDateId);return false});$("#"+this.calendarId).bind("click",function(t){t.stopPropagation()});$("#"+this.startCompareDateId).bind("click",function(){if(s.endDateId==s.dateInput){$("#"+s.startDateId).val(s.startDefDate)}s.startDefDate="";s.removeCSS(0);s.changeInput(s.startCompareDateId);return false});$("#"+this.submitBtn).bind("click",function(){s.close(1);s.mOpts.success({startDate:$("#"+s.mOpts.startDateId).val(),endDate:$("#"+s.mOpts.endDateId).val(),needCompare:$("#"+s.mOpts.compareCheckboxId).val(),startCompareDate:$("#"+s.mOpts.startCompareDateId).val(),endCompareDate:$("#"+s.mOpts.endCompareDateId).val()});return false});$("#"+this.closeBtn).bind("click",function(){s.close();return false});$("#"+this.inputId).bind("click",function(){s.init();s.show(false,s);return false});$("#"+this.mOpts.inputTrigger).bind("click",function(){s.init();s.show(false,s);return false});$("#"+this.mOpts.compareTrigger).bind("click",function(){s.init(true);s.show(true,s);return false});$("#"+this.inputCompareId).bind("click",function(){s.init(true);s.show(true,s);return false});if(this.mOpts.singleCompare){if(this.mOpts.theme==="ta"){$("#"+s.startDateId).val(s.mOpts.startDate);$("#"+s.endDateId).val(s.mOpts.startDate);$("#"+s.startCompareDateId).val(s.mOpts.startCompareDate);$("#"+s.endCompareDateId).val(s.mOpts.startCompareDate)}else{$("#"+s.startDateId).val(s.mOpts.startDate);$("#"+s.endDateId).val(s.mOpts.startDate);$("#"+s.startCompareDateId).val(s.mOpts.startCompareDate);$("#"+s.endCompareDateId).val(s.mOpts.startCompareDate);$("#"+this.compareCheckboxId).attr("checked",true);$("#"+this.mOpts.compareCheckboxId).attr("checked",true)}}$("#"+this.dateRangeCompareDiv).css("display",$("#"+this.compareCheckboxId).attr("checked")?"":"none");$("#"+this.compareInputDiv).css("display",$("#"+this.compareCheckboxId).attr("checked")?"":"none");$("#"+this.compareCheckboxId).bind("click",function(){$("#"+s.inputCompareId).css("display",this.checked?"":"none");$("#"+s.dateRangeCompareDiv).css("display",this.checked?"":"none");$("#"+s.compareInputDiv).css("display",this.checked?"":"none");$("#"+s.startCompareDateId).css("disabled",this.checked?false:true);$("#"+s.endCompareDateId).css("disabled",this.checked?false:true);$("#"+s.mOpts.compareCheckboxId).attr("checked",$("#"+s.compareCheckboxId).attr("checked"));$("#"+s.mOpts.compareCheckboxId).val($("#"+s.compareCheckboxId).attr("checked")?1:0);if($("#"+s.compareCheckboxId).attr("checked")){sDate=s.str2date($("#"+s.startDateId).val());sTime=sDate.getTime();eDate=s.str2date($("#"+s.endDateId).val());eTime=eDate.getTime();scDate=$("#"+s.startCompareDateId).val();ecDate=$("#"+s.endCompareDateId).val();if(""==scDate||""==ecDate){ecDate=s.str2date(s.date2ymd(sDate).join("-"));ecDate.setDate(ecDate.getDate()-1);scDate=s.str2date(s.date2ymd(sDate).join("-"));scDate.setDate(scDate.getDate()-(eTime-sTime)/864e5-1);if(ecDate.getTime()<s.mOpts.minValidDate*1e3){scDate=sDate;ecDate=eDate}if(ecDate.getTime()>=s.mOpts.minValidDate*1e3&&scDate.getTime()<s.mOpts.minValidDate*1e3){scDate.setTime(s.mOpts.minValidDate*1e3);scDate=s.str2date(s.date2ymd(scDate).join("-"));ecDate.setDate(scDate.getDate()+(eTime-sTime)/864e5-1)}$("#"+s.startCompareDateId).val(s.formatDate(s.date2ymd(scDate).join("-")));$("#"+s.endCompareDateId).val(s.formatDate(s.date2ymd(ecDate).join("-")))}s.addCSS(1);s.changeInput(s.startCompareDateId)}else{s.removeCSS(1);s.changeInput(s.startDateId)}s.close(1);s.mOpts.success({startDate:$("#"+s.mOpts.startDateId).val(),endDate:$("#"+s.mOpts.endDateId).val(),needCompare:$("#"+s.mOpts.compareCheckboxId).val(),startCompareDate:$("#"+s.mOpts.startCompareDateId).val(),endCompareDate:$("#"+s.mOpts.endCompareDateId).val()})});this.init();this.close(1);if(this.mOpts.replaceBtn&&$("#"+this.mOpts.replaceBtn).length>0){$("#"+s.compareCheckboxId).hide();$(".contrast").hide();$("#"+this.mOpts.replaceBtn).bind("click",function(){var t=this;$("#"+s.compareCheckboxId).attr("checked")?$("#"+s.compareCheckboxId).removeAttr("checked"):$("#"+s.compareCheckboxId).attr("checked","checked");$("#"+s.compareCheckboxId).click();$("#"+s.compareCheckboxId).attr("checked")?function(){$("#"+s.compareCheckboxId).removeAttr("checked");$(".contrast").hide();$(t).text("按时间对比")}():function(){$("#"+s.compareCheckboxId).attr("checked","checked");$(".contrast").show();$(t).text("取消对比")}()})}if(this.mOpts.autoCommit){this.mOpts.success({startDate:$("#"+s.mOpts.startDateId).val(),endDate:$("#"+s.mOpts.endDateId).val(),needCompare:$("#"+s.mOpts.compareCheckboxId).val(),startCompareDate:$("#"+s.mOpts.startCompareDateId).val(),endCompareDate:$("#"+s.mOpts.endCompareDateId).val()})}$(document).bind("click",function(){s.close()})}pickerDateRange.prototype.init=function(t){var e=this;var a,s;var i=typeof t!="undefined"?t&&$("#"+e.compareCheckboxId).attr("checked"):$("#"+e.compareCheckboxId).attr("checked");$("#"+this.dateListId).empty();var d=""==this.mOpts.endDate?new Date:this.str2date(this.mOpts.endDate);this.calendar_endDate=new Date(d.getFullYear(),d.getMonth()+1,0);if(this.mOpts.magicSelect&&this.mOpts.theme=="ta"){var r=0;do{var n=null;if(r==0){n=this.fillDate(this.str2date($("#"+this.endDateId).val()).getFullYear(),this.str2date($("#"+this.endDateId).val()).getMonth(),r);$("#"+this.dateListId).append(n)}else{n=this.fillDate(this.str2date($("#"+this.startDateId).val()).getFullYear(),this.str2date($("#"+this.startDateId).val()).getMonth(),r);var p=this.mOpts.theme=="ta"?$("#"+this.dateListId).find("table").get(0):$("#"+this.dateListId).find("td").get(0);$(p).before(n)}r++}while(r<2);this.calendar_startDate=new Date(this.str2date($("#"+this.startDateId).val()).getFullYear(),this.str2date($("#"+this.startDateId).val()).getMonth(),1)}else{for(var r=0;r<this.mOpts.calendars;r++){var n=null;if(this.mOpts.theme=="ta"){n=this.fillDate(d.getFullYear(),d.getMonth(),r)}else{n=document.createElement("td");$(n).append(this.fillDate(d.getFullYear(),d.getMonth(),r));$(n).css("vertical-align","top")}if(0==r){$("#"+this.dateListId).append(n)}else{var p=this.mOpts.theme=="ta"?$("#"+this.dateListId).find("table").get(0):$("#"+this.dateListId).find("td").get(0);$(p).before(n)}d.setMonth(d.getMonth()-1,1)}this.calendar_startDate=new Date(d.getFullYear(),d.getMonth()+1,1)}$("#"+this.preMonth).bind("click",function(){e.calendar_endDate.setMonth(e.calendar_endDate.getMonth()-1,1);e.mOpts.endDate=e.date2ymd(e.calendar_endDate).join("-");e.init(t);if(1==e.mOpts.calendars){if(""==$("#"+e.startDateId).val()){e.changeInput(e.startDateId)}else{e.changeInput(e.endDateId)}}return false});$("#"+this.nextMonth).bind("click",function(){e.calendar_endDate.setMonth(e.calendar_endDate.getMonth()+1,1);e.mOpts.endDate=e.date2ymd(e.calendar_endDate).join("-");e.init(t);if(1==e.mOpts.calendars){if(""==$("#"+e.startDateId).val()){e.changeInput(e.startDateId)}else{e.changeInput(e.endDateId)}}return false});if(this.mOpts.magicSelect)this.bindChangeForSelect();if(this.endDateId!=this.dateInput&&this.endCompareDateId!=this.dateInput){i&&typeof t!="undefined"?this.addCSS(1):this.addCSS(0)}if(i&&typeof t!="undefined"){e.addCSS(1)}else{e.addCSS(0)}$("#"+e.inputCompareId).css("display",i?"":"none");$("#"+this.compareInputDiv).css("display",$("#"+this.compareCheckboxId).attr("checked")?"":"none");for(var h in e.periodObj){if($("#"+h).length>0){$("#"+h).unbind("click");$("#"+h).bind("click",function(){var t=e.mOpts.theme=="ta"?"active":"a";$(this).parent().nextAll().removeClass(t);$(this).parent().prevAll().removeClass(t);$(this).parent().addClass(t);var a=e.getSpecialPeriod(e.periodObj[$(this).attr("id")]);$("#"+e.startDateId).val(e.formatDate(a.otherday));$("#"+e.endDateId).val(e.formatDate(a.today));$("#"+e.mOpts.startDateId).val($("#"+e.startDateId).val());$("#"+e.mOpts.endDateId).val($("#"+e.endDateId).val());e.mOpts.theme=="ta"?$("#"+e.compareInputDiv).hide():$("#"+e.inputCompareId).css("display","none");$("#"+e.compareCheckboxId).attr("checked",false);$("#"+e.mOpts.compareCheckboxId).attr("checked",false);$("#"+this.compareInputDiv).css("display",$("#"+this.compareCheckboxId).attr("checked")?"":"none");e.close(1);$("#"+e.startCompareDateId).val("");$("#"+e.endCompareDateId).val("");$("#"+e.mOpts.startCompareDateId).val("");$("#"+e.mOpts.endCompareDateId).val("");$("#"+e.mOpts.compareCheckboxId).val(0);if($("#"+e.mOpts.replaceBtn).length>0){$(".contrast").hide();$("#"+e.mOpts.replaceBtn).text("按时间对比")}e.mOpts.success({startDate:$("#"+e.mOpts.startDateId).val(),endDate:$("#"+e.mOpts.endDateId).val(),needCompare:$("#"+e.mOpts.compareCheckboxId).val(),startCompareDate:$("#"+e.mOpts.startCompareDateId).val(),endCompareDate:$("#"+e.mOpts.endCompareDateId).val()})})}}$(document).bind("click",function(){e.close()});$("#"+this.inputId).bind("change",function(){if($(this).val()===""){$("#"+e.startDateId).val("");$("#"+e.endDateId).val("");$("#"+e.startCompareDateId).val("");$("#"+e.endCompareDateId).val("")}})};pickerDateRange.prototype.bindChangeForSelect=function(){var t=this;var e=function t(e,a,s,i){i=i||"open";var d=null,r=500;function n(){$("#"+a).removeClass(i)}function p(){$("#"+a).addClass(i)}function h(){return $("#"+a).attr("class")==i}$("#"+e).click(function(){h()?n():p()}).mouseover(function(){clearTimeout(d)}).mouseout(function(){d=setTimeout(n,r)});$("#"+s).mouseover(function(){clearTimeout(d)}).mouseout(function(){d=setTimeout(n,r)})};try{$("#"+this.dateListId).find('div[id*="selected"]').each(function(){var a=$(this).attr("id").match(/(\w+)_(\d)/i);if(a){var s=a[1];var i=a[2];if(s=="yselected"){e("_ybtn_"+i,$(this).attr("id"),"_yctn_"+i)}else if(s=="mselected"){e("_mbtn_"+i,$(this).attr("id"),"_mctn_"+i)}$(this).find("li a").each(function(){$(this).click(function(){var e=$(this).parents(".select_wrap").attr("id").match(/(\w+)_(\d)/i);var a=e[1];var s=e[2];var i=null;if(s^1==0){if(a=="yselected"){t.calendar_startDate.setYear($(this).text()*1,1)}else if(a="mselected"){t.calendar_startDate.setMonth($(this).text()*1-1,1)}t.mOpts.startDate=t.date2ymd(t.calendar_startDate).join("-");i=t.fillDate(t.calendar_startDate.getFullYear(),t.calendar_startDate.getMonth(),s)}else{if(a=="yselected"){t.calendar_endDate.setYear($(this).text()*1,1)}else if(a="mselected"){t.calendar_endDate.setMonth($(this).text()*1-1,1)}t.mOpts.endDate=t.date2ymd(t.calendar_endDate).join("-");i=t.fillDate(t.calendar_endDate.getFullYear(),t.calendar_endDate.getMonth(),s)}var d=$("#"+t.dateListId).find("table").get(s^1);$(d).replaceWith(i);t.removeCSS(0);t.bindChangeForSelect()})})}})}catch(t){window.console&&console.log(t)}};pickerDateRange.prototype.getSpecialPeriod=function(t){var e=this;var a=new Date;true==e.mOpts.isTodayValid&&""!=e.mOpts.isTodayValid||2>t?"":a.setTime(a.getTime()-1*24*60*60*1e3);var s=a.getTime()-t*24*60*60*1e3<e.mOpts.minValidDate*1e3?e.mOpts.minValidDate*1e3:a.getTime()-t*24*60*60*1e3;var i=a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate();a.setTime(s);var d=a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate();if(t==e.periodObj.aYesterday){i=d}return{today:i,otherday:d}};pickerDateRange.prototype.getCurrentDate=function(){return{startDate:$("#"+this.mOpts.startDateId).val(),endDate:$("#"+this.mOpts.endDateId).val(),needCompare:$("#"+this.mOpts.compareCheckboxId).val(),startCompareDate:$("#"+this.mOpts.startCompareDateId).val(),endCompareDate:$("#"+this.mOpts.endCompareDateId).val()}};pickerDateRange.prototype.removeCSS=function(t,e){if("undefined"==typeof e){e=this.mOpts.theme+"_"+this.mOpts.coincideCss}if("undefined"==typeof t){t=0}var a=this.calendar_startDate;var s=this.calendar_endDate;if(this.mOpts.magicSelect){a=this.str2date($("#"+this.startDateId).val());s=this.str2date($("#"+this.endDateId).val())}var i=new Date(a.getFullYear(),a.getMonth(),a.getDate());var d="";for(var r=new Date(i);r.getTime()<=s.getTime();r.setDate(r.getDate()+1)){if(0==t){d=this.mOpts.theme+"_"+this.mOpts.selectCss}else{d=this.mOpts.theme+"_"+this.mOpts.compareCss}$("#"+this.calendarId+"_"+this.date2ymd(r).join("-")).removeClass(d);$("#"+this.calendarId+"_"+this.date2ymd(r).join("-")).removeClass(this.mOpts.firstCss).removeClass(this.mOpts.lastCss).removeClass(this.mOpts.clickCss)}};pickerDateRange.prototype.addCSS=function(t,e){if("undefined"==typeof e){e=this.mOpts.theme+"_"+this.mOpts.coincideCss}if("undefined"==typeof t){t=0}var a=this.str2date($("#"+this.startDateId).val());var s=this.str2date($("#"+this.endDateId).val());var i=this.str2date($("#"+this.startCompareDateId).val());var d=this.str2date($("#"+this.endCompareDateId).val());var r=0==t?a:i;var n=0==t?s:d;var p="";for(var h=new Date(r);h.getTime()<=n.getTime();h.setDate(h.getDate()+1)){if(0==t){p=this.mOpts.theme+"_"+this.mOpts.selectCss;$("#"+this.calendarId+"_"+this.date2ymd(h).join("-")).removeClass(this.mOpts.firstCss).removeClass(this.mOpts.lastCss).removeClass(this.mOpts.clickCss);$("#"+this.calendarId+"_"+this.date2ymd(h).join("-")).removeClass(p)}else{p=this.mOpts.theme+"_"+this.mOpts.compareCss}$("#"+this.calendarId+"_"+this.date2ymd(h).join("-")).attr("class",p)}if(this.mOpts.theme=="ta"){$("#"+this.calendarId+"_"+this.date2ymd(new Date(r)).join("-")).removeClass().addClass(this.mOpts.firstCss);$("#"+this.calendarId+"_"+this.date2ymd(new Date(n)).join("-")).removeClass().addClass(this.mOpts.lastCss);r.getTime()==n.getTime()&&$("#"+this.calendarId+"_"+this.date2ymd(new Date(n)).join("-")).removeClass().addClass(this.mOpts.clickCss)}};pickerDateRange.prototype.checkDateRange=function(t,e){var a=this.str2date(t);var s=this.str2date(e);var i=a.getTime();var d=s.getTime();var r,n;if(d>=i){n=this.str2date(t);n.setMonth(n.getMonth()+this.mOpts.monthRangeMax);n.setDate(n.getDate()+this.mOpts.dayRangeMax-1);if(n.getTime()<d){alert("结束日期不能大于："+this.date2ymd(n).join("-"));return false}}else{n=this.str2date(e);n.setMonth(n.getMonth()-this.mOpts.monthRangeMax);n.setDate(n.getDate()-this.mOpts.dayRangeMax+1);if(n.getTime()>d){alert("开始日期不能小于："+this.date2ymd(n).join("-"));return false}}return true};pickerDateRange.prototype.selectDate=function(t){this.changeInput(this.dateInput);var e=this.formatDate(t);if(this.startDateId==this.dateInput){this.removeCSS(0);this.removeCSS(1);$("#"+this.calendarId+"_"+t).attr("class",this.mOpts.theme=="ta"?this.mOpts.clickCss:this.mOpts.theme+"_"+this.mOpts.selectCss);this.startDefDate=$("#"+this.dateInput).val();$("#"+this.dateInput).val(e);if(true==this.mOpts.singleCompare||true==this.mOpts.isSingleDay){this.dateInput=this.startDateId;$("#"+this.endDateId).val(e);(this.mOpts.shortOpr||this.mOpts.autoSubmit)&&this.close(1);this.mOpts.success({startDate:$("#"+this.mOpts.startDateId).val(),endDate:$("#"+this.mOpts.endDateId).val(),needCompare:$("#"+this.mOpts.compareCheckboxId).val(),startCompareDate:$("#"+this.mOpts.startCompareDateId).val(),endCompareDate:$("#"+this.mOpts.endCompareDateId).val()})}else{this.dateInput=this.endDateId}}else if(this.endDateId==this.dateInput){if(""==$("#"+this.startDateId).val()){this.dateInput=this.startDateId;this.selectDate(t);return false}if(false==this.checkDateRange($("#"+this.startDateId).val(),t)){return false}if(-1==this.compareStrDate(t,$("#"+this.startDateId).val())){$("#"+this.dateInput).val($("#"+this.startDateId).val());$("#"+this.startDateId).val(e);e=$("#"+this.dateInput).val()}$("#"+this.dateInput).val(e);this.dateInput=this.startDateId;this.removeCSS(0);this.addCSS(0);this.startDefDate="";if(this.mOpts.autoSubmit){this.close(1);this.mOpts.success({startDate:$("#"+this.mOpts.startDateId).val(),endDate:$("#"+this.mOpts.endDateId).val(),needCompare:$("#"+this.mOpts.compareCheckboxId).val(),startCompareDate:$("#"+this.mOpts.startCompareDateId).val(),endCompareDate:$("#"+this.mOpts.endCompareDateId).val()})}}else if(this.startCompareDateId==this.dateInput){this.removeCSS(1);this.removeCSS(0);$("#"+this.calendarId+"_"+t).attr("class",this.mOpts.theme=="ta"?this.mOpts.clickCss:this.mOpts.theme+"_"+this.mOpts.compareCss);this.startDefDate=$("#"+this.dateInput).val();$("#"+this.dateInput).val(e);if(true==this.mOpts.singleCompare||true==this.mOpts.isSingleDay){this.dateInput=this.startCompareDateId;$("#"+this.endCompareDateId).val(e);(this.mOpts.shortOpr||this.mOpts.autoSubmit)&&this.close(1);this.mOpts.success({startDate:$("#"+this.mOpts.startDateId).val(),endDate:$("#"+this.mOpts.endDateId).val(),needCompare:$("#"+this.mOpts.compareCheckboxId).val(),startCompareDate:$("#"+this.mOpts.startCompareDateId).val(),endCompareDate:$("#"+this.mOpts.endCompareDateId).val()})}else{this.dateInput=this.endCompareDateId}}else if(this.endCompareDateId==this.dateInput){if(""==$("#"+this.startCompareDateId).val()){this.dateInput=this.startCompareDateId;this.selectDate(t);return false}if(false==this.checkDateRange($("#"+this.startCompareDateId).val(),t)){return false}if(-1==this.compareStrDate(t,$("#"+this.startCompareDateId).val())){$("#"+this.dateInput).val($("#"+this.startCompareDateId).val());$("#"+this.startCompareDateId).val(e);e=$("#"+this.dateInput).val()}$("#"+this.dateInput).val(e);this.dateInput=this.startCompareDateId;this.removeCSS(1);this.addCSS(1);this.startDefDate="";if(this.mOpts.autoSubmit){this.close(1);this.mOpts.success({startDate:$("#"+this.mOpts.startDateId).val(),endDate:$("#"+this.mOpts.endDateId).val(),needCompare:$("#"+this.mOpts.compareCheckboxId).val(),startCompareDate:$("#"+this.mOpts.startCompareDateId).val(),endCompareDate:$("#"+this.mOpts.endCompareDateId).val()})}}};pickerDateRange.prototype.show=function(t,e){$("#"+e.dateRangeDiv).css("display",t?"none":"");$("#"+e.dateRangeCompareDiv).css("display",t?"":"none");var a=t?$("#"+this.inputCompareId).offset():$("#"+this.inputId).offset();var s=t?$("#"+this.inputCompareId).height():$("#"+this.inputId).height();var i=parseInt($(document.body)[0].clientWidth);var d=a.left;$("#"+this.calendarId).css("display","block");if(true==this.mOpts.singleCompare||true==this.mOpts.isSingleDay){$("#"+this.endDateId).css("display","none");$("#"+this.endCompareDateId).css("display","none");$("#"+this.mOpts.joinLineId).css("display","none");$("."+this.mOpts.joinLineId).css("display","none")}if(0<i&&$("#"+this.calendarId).width()+a.left>i){d=a.left+$("#"+this.inputId).width()-$("#"+this.calendarId).width()+(/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)?5:0);e.mOpts.theme=="ta"&&(d+=50)}$("#"+this.calendarId).css("left",d+"px");$("#"+this.calendarId).css("top",a.top+(e.mOpts.theme=="ta"?35:22)+"px");t?this.changeInput(this.startCompareDateId):this.changeInput(this.startDateId);return false};pickerDateRange.prototype.close=function(t){var e=this;if(t){if(this.mOpts.shortOpr===true){$("#"+this.inputId).val($("#"+this.startDateId).val());$("#"+this.inputCompareId).val($("#"+this.startCompareDateId).val())}else{$("#"+this.inputId).val($("#"+this.startDateId).val()+(""==$("#"+this.endDateId).val()?"":this.mOpts.defaultText+$("#"+this.endDateId).val()))}var a=true==this.mOpts.isTodayValid&&""!=this.mOpts.isTodayValid?(new Date).getTime():(new Date).getTime()-1*24*60*60*1e3;var s=this.str2date($("#"+this.startDateId).val()).getTime();var i=this.str2date($("#"+this.endDateId).val()).getTime();if(i<s){var d=$("#"+this.startDateId).val();$("#"+this.startDateId).val($("#"+this.endDateId).val());$("#"+this.endDateId).val(d)}var r=this.mOpts.shortOpr==true?$("#"+this.startDateId).val():$("#"+this.startDateId).val()+(""==$("#"+this.endDateId).val()?"":this.mOpts.defaultText+$("#"+this.endDateId).val());var n=document.getElementById(this.inputId);if(n&&n.tagName=="INPUT"){$("#"+this.inputId).val(r);$("#"+this.inputCompareId).is(":visible")&&$("#"+this.inputCompareId).val(o)}else{$("#"+this.inputId).html(r);$("#"+this.inputCompareId).is(":visible")&&$("#"+this.inputCompareId).html(o)}if(this.mOpts.theme!="ta"){if(""!=$("#"+this.startCompareDateId).val()&&""!=$("#"+this.endCompareDateId).val()){var p=this.str2date($("#"+this.startCompareDateId).val()).getTime();var h=this.str2date($("#"+this.endCompareDateId).val()).getTime();var m=p+i-s;if(m>a){m=a;$("#"+this.startCompareDateId).val(this.formatDate(this.date2ymd(new Date(m+s-i)).join("-")))}$("#"+this.endCompareDateId).val(this.formatDate(this.date2ymd(new Date(m)).join("-")));var p=this.str2date($("#"+this.startCompareDateId).val()).getTime();var h=this.str2date($("#"+this.endCompareDateId).val()).getTime();if(h<p){var d=$("#"+this.startCompareDateId).val();$("#"+this.startCompareDateId).val($("#"+this.endCompareDateId).val());$("#"+this.endCompareDateId).val(d)}}}var o=this.mOpts.shortOpr==true?$("#"+this.startCompareDateId).val():$("#"+this.startCompareDateId).val()+(""==$("#"+this.endCompareDateId).val()?"":this.mOpts.defaultText+$("#"+this.endCompareDateId).val());if(n&&n.tagName=="INPUT"){$("#"+this.inputCompareId).val(o)}else{$("#"+this.inputCompareId).html(o)}var l=(s-i)/864e5;$("#"+this.mOpts.startDateId).val($("#"+this.startDateId).val());$("#"+this.mOpts.endDateId).val($("#"+this.endDateId).val());$("#"+this.mOpts.startCompareDateId).val($("#"+this.startCompareDateId).val());$("#"+this.mOpts.endCompareDateId).val($("#"+this.endCompareDateId).val());for(var c in this.periodObj){if($("#"+this.mOpts[c])){$("#"+this.mOpts[c]).parent().removeClass("a")}}}$("#"+e.calendarId).css("display","none");return false};pickerDateRange.prototype.fillDate=function(t,e,a){var s=this;var i=this.mOpts.theme=="ta";var d=new Date(t,e,1);var r=new Date(t,e,1);var n=r.getDay();r.setDate(1-n);var p=new Date(t,e+1,0);var h=new Date(t,e+1,0);n=h.getDay();h.setDate(h.getDate()+6-n);var m=new Date;var o=m.getDate();var l=m.getMonth();var c=m.getFullYear();var D=document.createElement("table");if(i){D.className=this.mOpts.dateTable;cap=document.createElement("caption");if(this.mOpts.magicSelect){var I=['<div class="select_wrap" id="yselected_'+a+'"><div class="select" id="_ybtn_'+a+'">'+t+'</div><div class="dropdown" id="_yctn_'+a+'"><ul class="list_menu">'];var v=['<div class="select_wrap" id="mselected_'+a+'"><div class="select" id="_mbtn_'+a+'">'+(e+1)+'</div><div class="dropdown" id="_mctn_'+a+'"><ul class="list_menu">'];C=1;yt=c;do{I.push('<li><a href="javascript:;">'+yt--+"</a></li>");v.push('<li><a href="javascript:;">'+C+++"</a></li>")}while(C<=12);I.push("</ul></div></div>");v.push("</ul></div></div>");$(cap).append(I.join("")+'<span class="joinLine"> 年 </span>'+v.join("")+'<span class="joinLine"> 月 </span>')}else{$(cap).append(t+"年"+(e+1)+"月")}$(D).append(cap);thead=document.createElement("thead");tr=document.createElement("tr");var u=["日","一","二","三","四","五","六"];for(var C=0;C<7;C++){th=document.createElement("th");$(th).append(u[C]);$(tr).append(th)}$(thead).append(tr);$(D).append(thead);tr=document.createElement("tr");td=document.createElement("td");if(!this.mOpts.magicSelect){if(0==a){$(td).append('<a href="javascript:void(0);" id="'+this.nextMonth+'"><i class="i_next"></i></a>')}if(a+1==this.mOpts.calendars){$(td).append('<a href="javascript:void(0);" id="'+this.preMonth+'"><i class="i_pre"></i></a>')}}$(td).attr("colSpan",7);$(td).css("text-align","center");$(tr).append(td);$(D).append(tr)}else{D.className=this.mOpts.theme+"_"+this.mOpts.dateTable;tr=document.createElement("tr");td=document.createElement("td");if(0==a){$(td).append('<a href="javascript:void(0);" id="'+this.nextMonth+'" class="gri_dateRangeNextMonth"><span>next</span></a>')}if(a+1==this.mOpts.calendars){
$(td).append('<a href="javascript:void(0);" id="'+this.preMonth+'" class="gri_dateRangePreMonth"><span>pre</span></a>')}$(td).append(t+"年"+(e+1)+"月");$(td).attr("colSpan",7);$(td).css("text-align","center");$(td).css("background-color","#F9F9F9");$(tr).append(td);$(D).append(tr);var u=["日","一","二","三","四","五","六"];tr=document.createElement("tr");for(var C=0;C<7;C++){td=document.createElement("td");$(td).append(u[C]);$(tr).append(td)}$(D).append(tr)}var O="",f=0,g="";for(var y=r;y.getTime()<=h.getTime();y.setDate(y.getDate()+1)){if(y.getTime()<d.getTime()){O=this.mOpts.theme+"_"+this.mOpts.disableGray;f="-1"}else if(y.getTime()>p.getTime()){O=this.mOpts.theme+"_"+this.mOpts.disableGray;f="1"}else if(this.mOpts.stopToday==true&&y.getTime()>m.getTime()||y.getTime()<s.mOpts.minValidDate*1e3||""!==s.mOpts.maxValidDate&&y.getTime()>s.mOpts.maxValidDate*1e3){O=this.mOpts.theme+"_"+this.mOpts.disableGray;f="2"}else{f="0";if(y.getDate()==o&&y.getMonth()==l&&y.getFullYear()==c){if(true==this.mOpts.isTodayValid){O=this.mOpts.theme+"_"+this.mOpts.isToday}else{O=this.mOpts.theme+"_"+this.mOpts.disableGray;f="2"}}else{O=""}if(this.mOpts.weekendDis&&(y.getDay()==6||y.getDay()==0)){O=this.mOpts.theme+"_"+this.mOpts.disableGray;f="3"}if(this.mOpts.disCertainDay&&this.mOpts.disCertainDay.length>0){for(var b in this.mOpts.disCertainDay){if(!isNaN(this.mOpts.disCertainDay[b])&&y.getDay()===this.mOpts.disCertainDay[b]){O=this.mOpts.theme+"_"+this.mOpts.disableGray;f="4"}}}if(this.mOpts.disCertainDate&&this.mOpts.disCertainDate.length>0){var k=false;for(var b in this.mOpts.disCertainDate){if(!isNaN(this.mOpts.disCertainDate[b])||isNaN(parseInt(this.mOpts.disCertainDate[b]))){if(this.mOpts.disCertainDate[0]===true){k=!!(y.getDate()!==this.mOpts.disCertainDate[b]);if(!k){break}}else{k=!!(y.getDate()===this.mOpts.disCertainDate[b]);if(k){break}}}}if(k){O=this.mOpts.theme+"_"+this.mOpts.disableGray;f="4"}}}if(0==y.getDay()){tr=document.createElement("tr")}td=document.createElement("td");td.innerHTML=y.getDate();if(""!=O){$(td).attr("class",O)}if(0==f){g=y.getFullYear()+"-"+(y.getMonth()+1)+"-"+y.getDate();$(td).attr("id",s.calendarId+"_"+g);$(td).css("cursor","pointer");(function(t){$(td).bind("click",t,function(){s.selectDate(t);return false})})(g)}$(tr).append(td);if(6==y.getDay()){$(D).append(tr)}}return D};pickerDateRange.prototype.str2date=function(t){var e=t.split("-");return new Date(e[0],e[1]-1,e[2])};pickerDateRange.prototype.compareStrDate=function(t,e){var a=this.str2date(t);var s=this.str2date(e);if(a.getTime()>s.getTime()){return 1}else if(a.getTime()==s.getTime()){return 0}else{return-1}};pickerDateRange.prototype.date2ymd=function(t){return[t.getFullYear(),t.getMonth()+1,t.getDate()]};pickerDateRange.prototype.changeInput=function(t){if(true==this.mOpts.isSingleDay){t=this.startDateId}var e=[this.startDateId,this.startCompareDateId,this.endDateId,this.endCompareDateId];var a="";if(t==this.startDateId||t==this.endDateId){a=this.mOpts.theme+"_"+this.mOpts.selectCss}else{a=this.mOpts.theme+"_"+this.mOpts.compareCss}if(t==this.endDateId&&this.mOpts.singleCompare){a=this.mOpts.theme+"_"+this.mOpts.compareCss}for(var s in e){$("#"+e[s]).removeClass(this.mOpts.theme+"_"+this.mOpts.selectCss);$("#"+e[s]).removeClass(this.mOpts.theme+"_"+this.mOpts.compareCss)}$("#"+t).addClass(a);$("#"+t).css("background-repeat","repeat");this.dateInput=t};pickerDateRange.prototype.formatDate=function(t){return t.replace(/(\d{4})\-(\d{1,2})\-(\d{1,2})/g,function(t,e,a,s){if(a<10){a="0"+a}if(s<10){s="0"+s}return e+"-"+a+"-"+s})};